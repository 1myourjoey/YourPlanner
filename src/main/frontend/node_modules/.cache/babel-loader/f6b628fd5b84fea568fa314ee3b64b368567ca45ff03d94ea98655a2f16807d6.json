{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import TrainCode from'./TrainCode';import RecommendedPlaces from'./RecommendedPlaces';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TrainList=_ref=>{let{depPlaceId,arrPlaceId,startDate,selectedTrains,setSelectedTrains}=_ref;const[trainData,setTrainData]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const formatDate=datetime=>{if(typeof datetime!=='string'){datetime=datetime.toString();}const year=datetime.substring(0,4);const month=datetime.substring(4,6);const day=datetime.substring(6,8);const hour=datetime.substring(8,10);const minute=datetime.substring(10,12);return\"\".concat(month,\"\\uC6D4 \").concat(day,\"\\uC77C \").concat(hour,\"\\uC2DC \").concat(minute,\"\\uBD84\");};const handleAddClick=train=>{if(!isTrainSelected(train.trainno)){const newTrain={...train,uniqueId:Date.now()+Math.random().toString(36).substr(2,9)};setSelectedTrains([...selectedTrains,newTrain]);}};const handleRemoveClick=trainno=>{setSelectedTrains(selectedTrains.filter(train=>train.trainno!==trainno));};const isTrainSelected=trainno=>{return selectedTrains.some(train=>train.trainno===trainno);};useEffect(()=>{const fetchTrainData=async()=>{try{setLoading(true);const serviceKey='LOr7zB0jDV+lQ6WGnVGCY+vG22rkxdPRMM36e7spCgFeKjRlh488A09FtjZbwnw6bEMMW3Virexop2ihnhIe7g==';const formattedDate=startDate.replace(/-/g,'');const allTrainData=[];for(const depCode of depPlaceId){for(const destCode of arrPlaceId){var _response$data$respon,_response$data$respon2,_response$data$respon3;const response=await axios.get('http://apis.data.go.kr/1613000/TrainInfoService/getStrtpntAlocFndTrainInfo',{params:{serviceKey,depPlaceId:depCode,arrPlaceId:destCode,depPlandTime:formattedDate,_type:'json',trainGradeCode:'00'}});const items=(_response$data$respon=response.data.response)===null||_response$data$respon===void 0?void 0:(_response$data$respon2=_response$data$respon.body)===null||_response$data$respon2===void 0?void 0:(_response$data$respon3=_response$data$respon2.items)===null||_response$data$respon3===void 0?void 0:_response$data$respon3.item;if(items&&Array.isArray(items)){const extractedData=items.map(item=>({traingradename:item.traingradename,depplandtime:item.depplandtime,arrplandtime:item.arrplandtime,depplacename:item.depplacename,arrplacename:item.arrplacename,adultcharge:item.adultcharge,trainno:item.trainno}));allTrainData.push(...extractedData);}else if(items){const extractedData=[{traingradename:items.traingradename,depplandtime:items.depplandtime,arrplandtime:items.arrplandtime,depplacename:items.depplacename,arrplacename:items.arrplacename,adultcharge:items.adultcharge,trainno:items.trainno}];allTrainData.push(...extractedData);}}}setTrainData(allTrainData);}catch(error){console.error('Error fetching data:',error);setError(error);}finally{setLoading(false);}};if(depPlaceId&&arrPlaceId&&startDate){fetchTrainData();}},[depPlaceId,arrPlaceId,startDate]);if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"\\uB85C\\uB529 \\uC911...\"});}if(error){return/*#__PURE__*/_jsxs(\"div\",{children:[\"\\uB370\\uC774\\uD130\\uB97C \\uBD88\\uB7EC\\uC624\\uB294 \\uC911 \\uC624\\uB958\\uAC00 \\uBC1C\\uC0DD\\uD588\\uC2B5\\uB2C8\\uB2E4: \",error.message]});}return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"ul\",{children:trainData.map((train,index)=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[train.traingradename,\" / \\uCD9C\\uBC1C: \",train.depplacename,\"\\uC5ED \",formatDate(train.depplandtime),\" / \\uB3C4\\uCC29: \",train.arrplacename,\"\\uC5ED \",formatDate(train.arrplandtime),\" / \\uC694\\uAE08: \",train.adultcharge,\"\\uC6D0 / \\uC5F4\\uCC28\\uBC88\\uD638: \",train.trainno]}),isTrainSelected(train.trainno)?/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRemoveClick(train.trainno),children:\"\\uC0AD\\uC81C\"}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAddClick(train),children:\"\\uCD94\\uAC00\"})]},train.trainno||index))})});};export default TrainList;","map":{"version":3,"names":["React","useState","useEffect","axios","TrainCode","RecommendedPlaces","jsx","_jsx","jsxs","_jsxs","TrainList","_ref","depPlaceId","arrPlaceId","startDate","selectedTrains","setSelectedTrains","trainData","setTrainData","loading","setLoading","error","setError","formatDate","datetime","toString","year","substring","month","day","hour","minute","concat","handleAddClick","train","isTrainSelected","trainno","newTrain","uniqueId","Date","now","Math","random","substr","handleRemoveClick","filter","some","fetchTrainData","serviceKey","formattedDate","replace","allTrainData","depCode","destCode","_response$data$respon","_response$data$respon2","_response$data$respon3","response","get","params","depPlandTime","_type","trainGradeCode","items","data","body","item","Array","isArray","extractedData","map","traingradename","depplandtime","arrplandtime","depplacename","arrplacename","adultcharge","push","console","children","message","index","onClick"],"sources":["C:/Users/윤기섭/Documents/GitHub/YourPlanner/src/main/frontend/src/components/js/TrainList.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport TrainCode from './TrainCode';\r\nimport RecommendedPlaces from './RecommendedPlaces';\r\n\r\nconst TrainList = ({ depPlaceId, arrPlaceId, startDate, selectedTrains, setSelectedTrains }) => {\r\n  const [trainData, setTrainData] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const formatDate = (datetime) => {\r\n    if (typeof datetime !== 'string') {\r\n      datetime = datetime.toString();\r\n    }\r\n    const year = datetime.substring(0, 4);\r\n    const month = datetime.substring(4, 6);\r\n    const day = datetime.substring(6, 8);\r\n    const hour = datetime.substring(8, 10);\r\n    const minute = datetime.substring(10, 12);\r\n    return `${month}월 ${day}일 ${hour}시 ${minute}분`;\r\n  };\r\n\r\n  const handleAddClick = (train) => {\r\n    if (!isTrainSelected(train.trainno)) {\r\n      const newTrain = { ...train, uniqueId: Date.now() + Math.random().toString(36).substr(2, 9) };\r\n      setSelectedTrains([...selectedTrains, newTrain]);\r\n    }\r\n  };\r\n\r\n  const handleRemoveClick = (trainno) => {\r\n    setSelectedTrains(selectedTrains.filter(train => train.trainno !== trainno));\r\n  };\r\n\r\n  const isTrainSelected = (trainno) => {\r\n    return selectedTrains.some(train => train.trainno === trainno);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchTrainData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const serviceKey = 'LOr7zB0jDV+lQ6WGnVGCY+vG22rkxdPRMM36e7spCgFeKjRlh488A09FtjZbwnw6bEMMW3Virexop2ihnhIe7g==';\r\n        const formattedDate = startDate.replace(/-/g, '');\r\n\r\n        const allTrainData = [];\r\n\r\n        for (const depCode of depPlaceId) {\r\n          for (const destCode of arrPlaceId) {\r\n            const response = await axios.get('http://apis.data.go.kr/1613000/TrainInfoService/getStrtpntAlocFndTrainInfo', {\r\n              params: {\r\n                serviceKey,\r\n                depPlaceId: depCode,\r\n                arrPlaceId: destCode,\r\n                depPlandTime: formattedDate,\r\n                _type: 'json',\r\n                trainGradeCode: '00'\r\n              }\r\n            });\r\n\r\n            const items = response.data.response?.body?.items?.item;\r\n\r\n            if (items && Array.isArray(items)) {\r\n              const extractedData = items.map(item => ({\r\n                traingradename: item.traingradename,\r\n                depplandtime: item.depplandtime,\r\n                arrplandtime: item.arrplandtime,\r\n                depplacename: item.depplacename,\r\n                arrplacename: item.arrplacename,\r\n                adultcharge: item.adultcharge,\r\n                trainno: item.trainno\r\n              }));\r\n              allTrainData.push(...extractedData);\r\n            } else if (items) {\r\n              const extractedData = [{\r\n                traingradename: items.traingradename,\r\n                depplandtime: items.depplandtime,\r\n                arrplandtime: items.arrplandtime,\r\n                depplacename: items.depplacename,\r\n                arrplacename: items.arrplacename,\r\n                adultcharge: items.adultcharge,\r\n                trainno: items.trainno\r\n              }];\r\n              allTrainData.push(...extractedData);\r\n            }\r\n          }\r\n        }\r\n\r\n        setTrainData(allTrainData);\r\n      } catch (error) {\r\n        console.error('Error fetching data:', error);\r\n        setError(error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (depPlaceId && arrPlaceId && startDate) {\r\n      fetchTrainData();\r\n    }\r\n  }, [depPlaceId, arrPlaceId, startDate]);\r\n\r\n  if (loading) {\r\n    return <div>로딩 중...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div>데이터를 불러오는 중 오류가 발생했습니다: {error.message}</div>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <ul>\r\n        {trainData.map((train, index) => (\r\n          <li key={train.trainno || index}>\r\n            <p>{train.traingradename} / 출발: {train.depplacename}역 {formatDate(train.depplandtime)} / 도착: {train.arrplacename}역 {formatDate(train.arrplandtime)} / 요금: {train.adultcharge}원 / 열차번호: {train.trainno}</p>\r\n            {isTrainSelected(train.trainno) ? (\r\n              <button onClick={() => handleRemoveClick(train.trainno)}>삭제</button>\r\n            ) : (\r\n              <button onClick={() => handleAddClick(train)}>추가</button>\r\n            )}\r\n          </li>\r\n        ))}\r\n      </ul>\r\n\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TrainList;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,SAAS,KAAM,aAAa,CACnC,MAAO,CAAAC,iBAAiB,KAAM,qBAAqB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEpD,KAAM,CAAAC,SAAS,CAAGC,IAAA,EAA8E,IAA7E,CAAEC,UAAU,CAAEC,UAAU,CAAEC,SAAS,CAAEC,cAAc,CAAEC,iBAAkB,CAAC,CAAAL,IAAA,CACzF,KAAM,CAACM,SAAS,CAAEC,YAAY,CAAC,CAAGjB,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACkB,OAAO,CAAEC,UAAU,CAAC,CAAGnB,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACoB,KAAK,CAAEC,QAAQ,CAAC,CAAGrB,QAAQ,CAAC,IAAI,CAAC,CAExC,KAAM,CAAAsB,UAAU,CAAIC,QAAQ,EAAK,CAC/B,GAAI,MAAO,CAAAA,QAAQ,GAAK,QAAQ,CAAE,CAChCA,QAAQ,CAAGA,QAAQ,CAACC,QAAQ,CAAC,CAAC,CAChC,CACA,KAAM,CAAAC,IAAI,CAAGF,QAAQ,CAACG,SAAS,CAAC,CAAC,CAAE,CAAC,CAAC,CACrC,KAAM,CAAAC,KAAK,CAAGJ,QAAQ,CAACG,SAAS,CAAC,CAAC,CAAE,CAAC,CAAC,CACtC,KAAM,CAAAE,GAAG,CAAGL,QAAQ,CAACG,SAAS,CAAC,CAAC,CAAE,CAAC,CAAC,CACpC,KAAM,CAAAG,IAAI,CAAGN,QAAQ,CAACG,SAAS,CAAC,CAAC,CAAE,EAAE,CAAC,CACtC,KAAM,CAAAI,MAAM,CAAGP,QAAQ,CAACG,SAAS,CAAC,EAAE,CAAE,EAAE,CAAC,CACzC,SAAAK,MAAA,CAAUJ,KAAK,YAAAI,MAAA,CAAKH,GAAG,YAAAG,MAAA,CAAKF,IAAI,YAAAE,MAAA,CAAKD,MAAM,WAC7C,CAAC,CAED,KAAM,CAAAE,cAAc,CAAIC,KAAK,EAAK,CAChC,GAAI,CAACC,eAAe,CAACD,KAAK,CAACE,OAAO,CAAC,CAAE,CACnC,KAAM,CAAAC,QAAQ,CAAG,CAAE,GAAGH,KAAK,CAAEI,QAAQ,CAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAGC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACjB,QAAQ,CAAC,EAAE,CAAC,CAACkB,MAAM,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAC7F3B,iBAAiB,CAAC,CAAC,GAAGD,cAAc,CAAEsB,QAAQ,CAAC,CAAC,CAClD,CACF,CAAC,CAED,KAAM,CAAAO,iBAAiB,CAAIR,OAAO,EAAK,CACrCpB,iBAAiB,CAACD,cAAc,CAAC8B,MAAM,CAACX,KAAK,EAAIA,KAAK,CAACE,OAAO,GAAKA,OAAO,CAAC,CAAC,CAC9E,CAAC,CAED,KAAM,CAAAD,eAAe,CAAIC,OAAO,EAAK,CACnC,MAAO,CAAArB,cAAc,CAAC+B,IAAI,CAACZ,KAAK,EAAIA,KAAK,CAACE,OAAO,GAAKA,OAAO,CAAC,CAChE,CAAC,CAEDlC,SAAS,CAAC,IAAM,CACd,KAAM,CAAA6C,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAI,CACF3B,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAA4B,UAAU,CAAG,0FAA0F,CAC7G,KAAM,CAAAC,aAAa,CAAGnC,SAAS,CAACoC,OAAO,CAAC,IAAI,CAAE,EAAE,CAAC,CAEjD,KAAM,CAAAC,YAAY,CAAG,EAAE,CAEvB,IAAK,KAAM,CAAAC,OAAO,GAAI,CAAAxC,UAAU,CAAE,CAChC,IAAK,KAAM,CAAAyC,QAAQ,GAAI,CAAAxC,UAAU,CAAE,KAAAyC,qBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CACjC,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAtD,KAAK,CAACuD,GAAG,CAAC,4EAA4E,CAAE,CAC7GC,MAAM,CAAE,CACNX,UAAU,CACVpC,UAAU,CAAEwC,OAAO,CACnBvC,UAAU,CAAEwC,QAAQ,CACpBO,YAAY,CAAEX,aAAa,CAC3BY,KAAK,CAAE,MAAM,CACbC,cAAc,CAAE,IAClB,CACF,CAAC,CAAC,CAEF,KAAM,CAAAC,KAAK,EAAAT,qBAAA,CAAGG,QAAQ,CAACO,IAAI,CAACP,QAAQ,UAAAH,qBAAA,kBAAAC,sBAAA,CAAtBD,qBAAA,CAAwBW,IAAI,UAAAV,sBAAA,kBAAAC,sBAAA,CAA5BD,sBAAA,CAA8BQ,KAAK,UAAAP,sBAAA,iBAAnCA,sBAAA,CAAqCU,IAAI,CAEvD,GAAIH,KAAK,EAAII,KAAK,CAACC,OAAO,CAACL,KAAK,CAAC,CAAE,CACjC,KAAM,CAAAM,aAAa,CAAGN,KAAK,CAACO,GAAG,CAACJ,IAAI,GAAK,CACvCK,cAAc,CAAEL,IAAI,CAACK,cAAc,CACnCC,YAAY,CAAEN,IAAI,CAACM,YAAY,CAC/BC,YAAY,CAAEP,IAAI,CAACO,YAAY,CAC/BC,YAAY,CAAER,IAAI,CAACQ,YAAY,CAC/BC,YAAY,CAAET,IAAI,CAACS,YAAY,CAC/BC,WAAW,CAAEV,IAAI,CAACU,WAAW,CAC7BxC,OAAO,CAAE8B,IAAI,CAAC9B,OAChB,CAAC,CAAC,CAAC,CACHe,YAAY,CAAC0B,IAAI,CAAC,GAAGR,aAAa,CAAC,CACrC,CAAC,IAAM,IAAIN,KAAK,CAAE,CAChB,KAAM,CAAAM,aAAa,CAAG,CAAC,CACrBE,cAAc,CAAER,KAAK,CAACQ,cAAc,CACpCC,YAAY,CAAET,KAAK,CAACS,YAAY,CAChCC,YAAY,CAAEV,KAAK,CAACU,YAAY,CAChCC,YAAY,CAAEX,KAAK,CAACW,YAAY,CAChCC,YAAY,CAAEZ,KAAK,CAACY,YAAY,CAChCC,WAAW,CAAEb,KAAK,CAACa,WAAW,CAC9BxC,OAAO,CAAE2B,KAAK,CAAC3B,OACjB,CAAC,CAAC,CACFe,YAAY,CAAC0B,IAAI,CAAC,GAAGR,aAAa,CAAC,CACrC,CACF,CACF,CAEAnD,YAAY,CAACiC,YAAY,CAAC,CAC5B,CAAE,MAAO9B,KAAK,CAAE,CACdyD,OAAO,CAACzD,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC5CC,QAAQ,CAACD,KAAK,CAAC,CACjB,CAAC,OAAS,CACRD,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,GAAIR,UAAU,EAAIC,UAAU,EAAIC,SAAS,CAAE,CACzCiC,cAAc,CAAC,CAAC,CAClB,CACF,CAAC,CAAE,CAACnC,UAAU,CAAEC,UAAU,CAAEC,SAAS,CAAC,CAAC,CAEvC,GAAIK,OAAO,CAAE,CACX,mBAAOZ,IAAA,QAAAwE,QAAA,CAAK,wBAAO,CAAK,CAAC,CAC3B,CAEA,GAAI1D,KAAK,CAAE,CACT,mBAAOZ,KAAA,QAAAsE,QAAA,EAAK,oHAAwB,CAAC1D,KAAK,CAAC2D,OAAO,EAAM,CAAC,CAC3D,CAEA,mBACEzE,IAAA,QAAAwE,QAAA,cACExE,IAAA,OAAAwE,QAAA,CACG9D,SAAS,CAACqD,GAAG,CAAC,CAACpC,KAAK,CAAE+C,KAAK,gBAC1BxE,KAAA,OAAAsE,QAAA,eACEtE,KAAA,MAAAsE,QAAA,EAAI7C,KAAK,CAACqC,cAAc,CAAC,mBAAO,CAACrC,KAAK,CAACwC,YAAY,CAAC,SAAE,CAACnD,UAAU,CAACW,KAAK,CAACsC,YAAY,CAAC,CAAC,mBAAO,CAACtC,KAAK,CAACyC,YAAY,CAAC,SAAE,CAACpD,UAAU,CAACW,KAAK,CAACuC,YAAY,CAAC,CAAC,mBAAO,CAACvC,KAAK,CAAC0C,WAAW,CAAC,qCAAU,CAAC1C,KAAK,CAACE,OAAO,EAAI,CAAC,CACzMD,eAAe,CAACD,KAAK,CAACE,OAAO,CAAC,cAC7B7B,IAAA,WAAQ2E,OAAO,CAAEA,CAAA,GAAMtC,iBAAiB,CAACV,KAAK,CAACE,OAAO,CAAE,CAAA2C,QAAA,CAAC,cAAE,CAAQ,CAAC,cAEpExE,IAAA,WAAQ2E,OAAO,CAAEA,CAAA,GAAMjD,cAAc,CAACC,KAAK,CAAE,CAAA6C,QAAA,CAAC,cAAE,CAAQ,CACzD,GANM7C,KAAK,CAACE,OAAO,EAAI6C,KAOtB,CACL,CAAC,CACA,CAAC,CAGF,CAAC,CAEV,CAAC,CAED,cAAe,CAAAvE,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}